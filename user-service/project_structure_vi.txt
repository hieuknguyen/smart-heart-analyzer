chat/
│
├── app/                         # Package chính của ứng dụng
│   ├── __init__.py
│   │
│   ├── main.py                 # File khởi động chính
│   │                          # - Khởi tạo ứng dụng FastAPI
│   │                          # - Cấu hình các router
│   │                          # - Khởi tạo các thành phần cần thiết
│   │
│   ├── database/              # Thư mục cấu hình database
│   │   ├── __init__.py
│   │   └── database.py       # - Thiết lập SQLAlchemy
│   │                         # - Quản lý phiên làm việc (session)
│   │                         # - Kết nối database
│   │
│   ├── models/               # Thư mục chứa các model database
│   │   ├── __init__.py
│   │   └── user.py          # - Định nghĩa model User
│   │                        # - Cấu trúc bảng trong database
│   │
│   ├── schemas/             # Thư mục chứa các schema (Pydantic models)
│   │   ├── __init__.py
│   │   └── user.py         # - Schema cho request/response
│   │                       # - Xác thực dữ liệu đầu vào/ra
│   │
│   ├── routers/            # Thư mục chứa các router (điều hướng API)
│   │   ├── __init__.py
│   │   └── user_router.py  # - Các endpoint liên quan đến user
│   │                       # - Xử lý các HTTP method
│   │
│   ├── services/           # Thư mục chứa logic nghiệp vụ
│   │   ├── __init__.py
│   │   └── user_service.py # - Xử lý logic cho user
│   │                       # - Tương tác với database
│   │
│   ├── websocket/          # Thư mục xử lý WebSocket
│   │   ├── __init__.py
│   │   ├── connection.py   # - Quản lý kết nối WebSocket
│   │   ├── handlers.py     # - Xử lý các message WebSocket
│   │   └── router.py       # - Định nghĩa route WebSocket
│   │
│   └── bloom.py           # Xử lý Bloom filter
│
└── requirements.txt       # File chứa các thư viện cần thiết

Luồng xử lý:

1. Luồng xử lý HTTP Request:
   Client Request
        ↓
   main.py (Ứng dụng FastAPI)
        ↓
   routers/user_router.py (Xử lý route)
        ↓
   services/user_service.py (Xử lý logic)
        ↓
   models/user.py (Tương tác database)
        ↓
   database/database.py (Kết nối database)

2. Luồng xử lý WebSocket:
   Kết nối WebSocket
        ↓
   websocket/router.py (Endpoint WebSocket)
        ↓
   websocket/connection.py (Quản lý kết nối)
        ↓
   websocket/handlers.py (Xử lý message)

3. Luồng xử lý dữ liệu:
   HTTP Request
        ↓
   schemas/user.py (Kiểm tra dữ liệu đầu vào)
        ↓
   Route Handler (Xử lý)
        ↓
   schemas/user.py (Kiểm tra dữ liệu đầu ra)
        ↓
   HTTP Response

Chức năng chính của từng module:

1. main.py:
   - Điểm khởi chạy ứng dụng
   - Cấu hình FastAPI
   - Đăng ký các router

2. database/database.py:
   - Cấu hình kết nối database
   - Quản lý phiên làm việc
   - Quản lý pool kết nối

3. models/user.py:
   - Định nghĩa cấu trúc bảng
   - Quan hệ giữa các bảng
   - Tương tác với SQLAlchemy

4. schemas/user.py:
   - Định nghĩa cấu trúc dữ liệu
   - Kiểm tra tính hợp lệ
   - Chuyển đổi dữ liệu

5. routers/user_router.py:
   - Định nghĩa các endpoint
   - Xử lý request
   - Định dạng response

6. services/user_service.py:
   - Xử lý logic nghiệp vụ
   - Thao tác với database
   - Xử lý dữ liệu

7. websocket/:
   - Xử lý giao tiếp realtime
   - Quản lý kết nối
   - Xử lý tin nhắn

8. bloom.py:
   - Kiểm tra email
   - Xử lý Bloom filter